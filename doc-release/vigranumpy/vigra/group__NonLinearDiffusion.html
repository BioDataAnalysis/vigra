<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><TITLE>vigra - Non-linear Diffusion and Total Variation</TITLE>
<link rel=stylesheet type="text/css" href="vigra.css">
<link rel=stylesheet type="text/css" href="vigra_1_8_2.css">
<link rel="shortcut icon" href="vigra-icon.ico" />
<script type="text/javascript">
function toggleHiddenDocumentation( textID, toggleID, toggleMessage )
{
	if( document.getElementById(textID).style.display == 'none' )
    {
		document.getElementById(textID).style.display = 'block';
        document.getElementById(toggleID).innerHTML = "hide " + toggleMessage;
    }
    else
    {
		document.getElementById(textID).style.display = 'none';
        document.getElementById(toggleID).innerHTML = "show " + toggleMessage;
	}
    return false;
}
</script>
<script>
var runOnLoad=function(c,o,d,e){function x(){for(e=1;c.length;)c.shift()()}o[d]?(document[d]('DOMContentLoaded',x,0),o[d]('load',x,0)):o.attachEvent('onload',x);return function(t){e?o.setTimeout(t,0):c.push(t)}}([],window,'addEventListener');
</script>
<script type="text/javascript" src="documents/CollapsibleLists.js"></script>
<script type="text/javascript">
    runOnLoad(function(){ CollapsibleLists.apply(); });
</script>
<style type="text/css">
.collapsibleList li.collapsibleListOpen{
  list-style-image:url('documents/pfeil.gif');
  cursor:pointer;
}
.collapsibleList li.collapsibleListClosed{
  list-style-image:url('documents/bullet.gif');
  cursor:pointer;
}
.collapsibleList li.lastItem{
  list-style-image:url('documents/diamond.gif');
}
</style>
</head>
<body  bgcolor="#f8f0e0" link="#0040b0" vlink="#a00040">
<basefont face="Helvetica,Arial,sans-serif" size=3>
<p align=right>
[ <a href="http://ukoethe.github.io/vigra/">VIGRA Homepage</a> |
 <a href="functionindex.html">Function Index</a> |
 <a href="classes.html">Class Index</a> |
 <a href="namespaces.html">Namespaces</a> |
 <a href="files.html">File List</a> |
 <a href="index.html">Main Page</a> ]
</p>
<!-- Generated by Doxygen 1.8.6 -->
</div><!-- top -->
<div class="contents">
<table class="main_heading">
<tr>
<td align=left>
<A HREF ="#_details" ><IMG BORDER=0 ALT="details" title="Detailed Description" SRC="documents/pfeilGross.gif"></A>
</td>
<td width="100%">Non-linear Diffusion and Total Variation
</td>
<td align=right><a href="http://hci.iwr.uni-heidelberg.de/vigra/"><IMG border=0 ALT="VIGRA" SRC="documents/vigra.gif" title="VIGRA Homepage"></a></td></tr>
</table><p>

<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvigra_1_1DiffusivityFunctor.html">DiffusivityFunctor&lt; Value &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diffusivity functor for non-linear diffusion.  <a href="classvigra_1_1DiffusivityFunctor.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab03d88e6a6ccf3dd060534d58b8db5b8"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:gab03d88e6a6ccf3dd060534d58b8db5b8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NonLinearDiffusion.html#gab03d88e6a6ccf3dd060534d58b8db5b8">anisotropicTotalVariationFilter</a> (...)</td></tr>
<tr class="memdesc:gab03d88e6a6ccf3dd060534d58b8db5b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs Anisotropic Total Variation Regularization.  <a href="#gab03d88e6a6ccf3dd060534d58b8db5b8">More...</a><br/></td></tr>
<tr class="separator:gab03d88e6a6ccf3dd060534d58b8db5b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga826a11a3e56ff35a8f3dc38f2c7c9a5e"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:ga826a11a3e56ff35a8f3dc38f2c7c9a5e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NonLinearDiffusion.html#ga826a11a3e56ff35a8f3dc38f2c7c9a5e">getAnisotropy</a> (...)</td></tr>
<tr class="memdesc:ga826a11a3e56ff35a8f3dc38f2c7c9a5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up directional data for anisotropic regularization.  <a href="#ga826a11a3e56ff35a8f3dc38f2c7c9a5e">More...</a><br/></td></tr>
<tr class="separator:ga826a11a3e56ff35a8f3dc38f2c7c9a5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga682a281ec8f2abbf2e3b18aaa7753c60"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:ga682a281ec8f2abbf2e3b18aaa7753c60"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NonLinearDiffusion.html#ga682a281ec8f2abbf2e3b18aaa7753c60">nonlinearDiffusion</a> (...)</td></tr>
<tr class="memdesc:ga682a281ec8f2abbf2e3b18aaa7753c60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform edge-preserving smoothing at the given scale.  <a href="#ga682a281ec8f2abbf2e3b18aaa7753c60">More...</a><br/></td></tr>
<tr class="separator:ga682a281ec8f2abbf2e3b18aaa7753c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c9b70b56775668688417757be6fc53c"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:ga8c9b70b56775668688417757be6fc53c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NonLinearDiffusion.html#ga8c9b70b56775668688417757be6fc53c">nonlinearDiffusionExplicit</a> (...)</td></tr>
<tr class="memdesc:ga8c9b70b56775668688417757be6fc53c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform edge-preserving smoothing at the given scale using an explicit scheme.  <a href="#ga8c9b70b56775668688417757be6fc53c">More...</a><br/></td></tr>
<tr class="separator:ga8c9b70b56775668688417757be6fc53c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga80e6e77f9e1a94080a3791981bb4fc0c"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:ga80e6e77f9e1a94080a3791981bb4fc0c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NonLinearDiffusion.html#ga80e6e77f9e1a94080a3791981bb4fc0c">secondOrderTotalVariationFilter</a> (...)</td></tr>
<tr class="memdesc:ga80e6e77f9e1a94080a3791981bb4fc0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs Anisotropic Total Variation Regularization.  <a href="#ga80e6e77f9e1a94080a3791981bb4fc0c">More...</a><br/></td></tr>
<tr class="separator:ga80e6e77f9e1a94080a3791981bb4fc0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga60041a186e8c6a6a7fb98a432bbee319"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:ga60041a186e8c6a6a7fb98a432bbee319"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__NonLinearDiffusion.html#ga60041a186e8c6a6a7fb98a432bbee319">totalVariationFilter</a> (...)</td></tr>
<tr class="memdesc:ga60041a186e8c6a6a7fb98a432bbee319"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs standard Total Variation Regularization.  <a href="#ga60041a186e8c6a6a7fb98a432bbee319">More...</a><br/></td></tr>
<tr class="separator:ga60041a186e8c6a6a7fb98a432bbee319"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="_details" id="details"></a><h2 class="details_section">Detailed Description</h2>
<p>Perform edge-preserving smoothing. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga682a281ec8f2abbf2e3b18aaa7753c60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::nonlinearDiffusion </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform edge-preserving smoothing at the given scale. </p>
<p>The algorithm solves the non-linear diffusion equation</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial}{\partial t} u = \frac{\partial}{\partial x} \left( g(|\nabla u|) \frac{\partial}{\partial x} u \right) \]" src="form_70.png"/>
</p>
<p>where <em> t</em> is the time, <b> x</b> is the location vector, <em> u(</em><b> x</b><em> , t)</em> is the smoothed image at time <em> t</em>, and <em> g(.)</em> is the location dependent diffusivity. At time zero, the image <em> u(</em><b> x</b><em> , 0)</em> is simply the original image. The time is proportional to the square of the scale parameter: <img class="formulaInl" alt="$t = s^2$" src="form_71.png"/>. The diffusion equation is solved iteratively according to the Additive Operator Splitting Scheme (AOS) from</p>
<p>J. Weickert: <em>"Recursive Separable Schemes for Nonlinear Diffusion
Filters"</em>, in: B. ter Haar Romeny, L. Florack, J. Koenderingk, M. Viergever (eds.): 1st Intl. Conf. on Scale-Space Theory in Computer Vision 1997, Springer LNCS 1252</p>
<p><code><a class="el" href="classvigra_1_1DiffusivityFunctor.html" title="Diffusivity functor for non-linear diffusion. ">DiffusivityFunctor</a></code> implements the gradient-dependent local diffusivity. It is passed as an argument to <a class="el" href="group__TransformAlgo.html#ga36fbe70cf44cf9289ca012b726f449d6">gradientBasedTransform()</a>. The return value must be between 0 and 1 and determines the weight a pixel gets when its neighbors are smoothed. Weickert recommends the use of the diffusivity implemented by class <a class="el" href="classvigra_1_1DiffusivityFunctor.html">DiffusivityFunctor</a>. It's also possible to use other functors, for example one that always returns 1, in which case we obtain the solution to the linear diffusion equation, i.e. <a class="el" href="classvigra_1_1Gaussian.html">Gaussian</a> convolution.</p>
<p>The source value type must be a linear space with internal addition, scalar multiplication, and NumericTraits defined. The value_type of the <a class="el" href="classvigra_1_1DiffusivityFunctor.html" title="Diffusivity functor for non-linear diffusion. ">DiffusivityFunctor</a> must be the scalar field over wich the source value type's linear space is defined.</p>
<p>In addition to <code><a class="el" href="group__NonLinearDiffusion.html#ga682a281ec8f2abbf2e3b18aaa7753c60" title="Perform edge-preserving smoothing at the given scale. ">nonlinearDiffusion()</a></code>, there is an algorithm <code><a class="el" href="group__NonLinearDiffusion.html#ga8c9b70b56775668688417757be6fc53c" title="Perform edge-preserving smoothing at the given scale using an explicit scheme. ">nonlinearDiffusionExplicit()</a></code> which implements the Explicit Scheme described in the above article. Both algorithms have the same interface, but the explicit scheme gives slightly more accurate approximations of the diffusion process at the cost of much slower processing.</p>
<p><b> Declarations:</b></p>
<p>pass 2D array views: </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>T1, <span class="keyword">class </span>S1,</div>
<div class="line">              <span class="keyword">class </span>T2, <span class="keyword">class </span>S2,</div>
<div class="line">              <span class="keyword">class </span>DiffusivityFunc&gt;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    <a class="code" href="group__NonLinearDiffusion.html#ga682a281ec8f2abbf2e3b18aaa7753c60">nonlinearDiffusion</a>(MultiArrayView&lt;2, T1, S1&gt; <span class="keyword">const</span> &amp; src,</div>
<div class="line">                       MultiArrayView&lt;2, T2, S2&gt; dest,</div>
<div class="line">                       DiffusivityFunc <span class="keyword">const</span> &amp; weight, <span class="keywordtype">double</span> scale);</div>
<div class="line">                               </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>T1, <span class="keyword">class </span>S1,</div>
<div class="line">              <span class="keyword">class </span>T2, <span class="keyword">class </span>S2,</div>
<div class="line">              <span class="keyword">class </span>DiffusivityFunc&gt;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    <a class="code" href="group__NonLinearDiffusion.html#ga8c9b70b56775668688417757be6fc53c">nonlinearDiffusionExplicit</a>(MultiArrayView&lt;2, T1, S1&gt; <span class="keyword">const</span> &amp; src,</div>
<div class="line">                               MultiArrayView&lt;2, T2, S2&gt; dest,</div>
<div class="line">                               DiffusivityFunc <span class="keyword">const</span> &amp; weight, <span class="keywordtype">double</span> scale);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a href="#" id="nonlinearDiffusion_OldAPIToggle" onclick="return toggleHiddenDocumentation(&apos;nonlinearDiffusion_OldAPI&apos;, &apos;nonlinearDiffusion_OldAPIToggle&apos;, &apos;deprecated declarations&apos;);">show deprecated declarations</a></p>
<div id="nonlinearDiffusion_OldAPI" style="display:none"> pass <a class="el" href="group__ImageIterators.html">Image Iterators</a> and <a class="el" href="group__DataAccessors.html">Data Accessors</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestIterator, <span class="keyword">class </span>DestAccessor,</div>
<div class="line">              <span class="keyword">class </span>DiffusivityFunctor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__NonLinearDiffusion.html#ga682a281ec8f2abbf2e3b18aaa7753c60">nonlinearDiffusion</a>(SrcIterator sul, SrcIterator slr, SrcAccessor as,</div>
<div class="line">                            DestIterator dul, DestAccessor ad,</div>
<div class="line">                            DiffusivityFunctor <span class="keyword">const</span> &amp; weight, <span class="keywordtype">double</span> scale);</div>
<div class="line">}</div>
</div><!-- fragment --><p> use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestIterator, <span class="keyword">class </span>DestAccessor,</div>
<div class="line">              <span class="keyword">class </span>DiffusivityFunctor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__NonLinearDiffusion.html#ga682a281ec8f2abbf2e3b18aaa7753c60">nonlinearDiffusion</a>(</div>
<div class="line">              triple&lt;SrcIterator, SrcIterator, SrcAccessor&gt; src,</div>
<div class="line">              pair&lt;DestIterator, DestAccessor&gt; dest,</div>
<div class="line">              DiffusivityFunctor <span class="keyword">const</span> &amp; weight, <span class="keywordtype">double</span> scale);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="nonlineardiffusion_8hxx_source.html">vigra/nonlineardiffusion.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><div class="line">MultiArray&lt;2, float&gt; src(w,h), dest(w,h);</div>
<div class="line"><span class="keywordtype">float</span> edge_threshold, scale;</div>
<div class="line">...</div>
<div class="line"></div>
<div class="line">nonlinearDiffusion(src, dest,</div>
<div class="line">                   DiffusivityFunctor&lt;float&gt;(edge_threshold), scale);</div>
</div><!-- fragment --><p><a href="#" id="nonlinearDiffusion_OldUsageToggle" onclick="return toggleHiddenDocumentation(&apos;nonlinearDiffusion_OldUsage&apos;, &apos;nonlinearDiffusion_OldUsageToggle&apos;, &apos;deprecated examples&apos;);">show deprecated examples</a></p>
<div id="nonlinearDiffusion_OldUsage" style="display:none"> <div class="fragment"><div class="line"><a class="code" href="group__StandardImageTypes.html#ga1170a9252f2ce52a075238e327ec78f0">FImage</a> src(w,h), dest(w,h);</div>
<div class="line"><span class="keywordtype">float</span> edge_threshold, scale;</div>
<div class="line">...</div>
<div class="line"></div>
<div class="line">nonlinearDiffusion(srcImageRange(src), destImage(dest),</div>
<div class="line">                   DiffusivityFunctor&lt;float&gt;(edge_threshold), scale);</div>
</div><!-- fragment --><p> <b> Required Interface:</b> </p>
<ul>
<li>
<code>SrcIterator</code> and <code>DestIterator</code> are models of <a class="el" href="classvigra_1_1ImageIterator.html" title="Standard 2D random access iterator for images that store the data in a linear array. ">ImageIterator</a> </li>
<li>
<code>SrcAccessor</code> and <code>DestAccessor</code> are models of <a class="el" href="classvigra_1_1StandardAccessor.html" title="Encapsulate access to the values an iterator points to. ">StandardAccessor</a> </li>
<li>
<code>SrcAccessor::value_type</code> is a linear space </li>
<li>
<code><a class="el" href="classvigra_1_1DiffusivityFunctor.html" title="Diffusivity functor for non-linear diffusion. ">DiffusivityFunctor</a></code> conforms to the requirements of <a class="el" href="group__TransformAlgo.html#ga36fbe70cf44cf9289ca012b726f449d6">gradientBasedTransform()</a>. Its range is between 0 and 1. </li>
<li>
<code><a class="el" href="classvigra_1_1DiffusivityFunctor.html#a04f69f8f2936ff309627511179c1709b">DiffusivityFunctor::value_type</a></code> is an algebraic field </li>
</ul>
</div><p><b> Precondition:</b></p>
<p><code>scale &gt; 0</code></p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="classvigra_1_1DiffusivityFunctor.html" title="Diffusivity functor for non-linear diffusion. ">vigra::DiffusivityFunctor</a> </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="smooth_8cxx-example.html#a9">smooth.cxx</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga8c9b70b56775668688417757be6fc53c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::nonlinearDiffusionExplicit </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform edge-preserving smoothing at the given scale using an explicit scheme. </p>
<p>See <a class="el" href="group__NonLinearDiffusion.html#ga682a281ec8f2abbf2e3b18aaa7753c60">nonlinearDiffusion()</a>. </p>

</div>
</div>
<a class="anchor" id="ga60041a186e8c6a6a7fb98a432bbee319"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::totalVariationFilter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs standard Total Variation Regularization. </p>
<p>The algorithm minimizes</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \min_u \int_\Omega \frac{1}{2} (u-f)^2\;dx + \alpha TV(u)\qquad\qquad (1) \]" src="form_93.png"/>
</p>
<p> where <em> <img class="formulaInl" alt="$ f=f(x)$" src="form_94.png"/></em> are the two dimensional noisy data, <em> <img class="formulaInl" alt="$ u=u(x)$" src="form_95.png"/></em> are the smoothed data,<em> <img class="formulaInl" alt="$ \alpha \ge 0 $" src="form_96.png"/></em> is the filter parameter and <em> <img class="formulaInl" alt="$ TV(u)$" src="form_97.png"/> </em> is the total variation semi-norm.</p>
<p><b> Declarations:</b></p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">      <span class="keyword">template</span> &lt;<span class="keyword">class</span> str<span class="keywordtype">id</span>e1,<span class="keyword">class</span> str<span class="keywordtype">id</span>e2&gt;</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="group__NonLinearDiffusion.html#ga60041a186e8c6a6a7fb98a432bbee319">totalVariationFilter</a>(MultiArrayView&lt;2,double,stride1&gt; data,</div>
<div class="line">                                MultiArrayView&lt;2,double,stride2&gt; out,</div>
<div class="line">                                <span class="keywordtype">double</span> alpha,</div>
<div class="line">                                <span class="keywordtype">int</span> steps,</div>
<div class="line">                                <span class="keywordtype">double</span> eps=0);</div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="group__NonLinearDiffusion.html#ga60041a186e8c6a6a7fb98a432bbee319">totalVariationFilter</a>(MultiArrayView&lt;2,double,stride1&gt; data,</div>
<div class="line">                                MultiArrayView&lt;2,double,stride2&gt; weight,</div>
<div class="line">                                MultiArrayView&lt;2,double,stride3&gt; out,</div>
<div class="line">                                <span class="keywordtype">double</span> alpha,</div>
<div class="line">                                <span class="keywordtype">int</span> steps,</div>
<div class="line">                                <span class="keywordtype">double</span> eps=0);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="el" href="group__NonLinearDiffusion.html#ga60041a186e8c6a6a7fb98a432bbee319">totalVariationFilter()</a> implements a primal-dual algorithm to solve (1).</p>
<p>Input: </p>
<table class="doxtable">
<tr>
<td><em>data</em>: </td><td>input data to be smoothed.  </td></tr>
<tr>
<td><em>alpha</em>: </td><td>smoothing parameter. </td></tr>
<tr>
<td><em>steps</em>: </td><td>maximal number of iteration steps.  </td></tr>
<tr>
<td><em>eps</em>: </td><td>The algorithm stops, if the primal-dual gap is below the threshold <em>eps</em>. </td></tr>
</table>
<p>Output:</p>
<p><em>out</em> contains the filtered data.</p>
<p>In addition, a point-wise weight ( <img class="formulaInl" alt="$ \ge 0 $" src="form_98.png"/>) for the data term can be provided (overloaded function).</p>
<p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="tv__filter_8hxx_source.html">vigra/tv_filter.hxx</a>&gt;</p>
<div class="fragment"><div class="line">MultiArray&lt;2,double&gt; data(Shape2(width,height));  <span class="comment">// to be initialized</span></div>
<div class="line">MultiArray&lt;2,double&gt; out(Shape2(width,height));</div>
<div class="line">MultiArray&lt;2,double&gt; weight(Shape2(width,height))); <span class="comment">//optional argument in overloaded function, to be initialized if used</span></div>
<div class="line"><span class="keywordtype">int</span> steps;        <span class="comment">// to be initialized</span></div>
<div class="line"><span class="keywordtype">double</span> alpha,eps; <span class="comment">// to be initialized</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="group__NonLinearDiffusion.html#ga60041a186e8c6a6a7fb98a432bbee319">totalVariationFilter</a>(data,out,alpha,steps,eps);</div>
</div><!-- fragment --><p> or </p>
<div class="fragment"><div class="line"><a class="code" href="group__NonLinearDiffusion.html#ga60041a186e8c6a6a7fb98a432bbee319">totalVariationFilter</a>(data,weight,out,alpha,steps,eps);</div>
</div><!-- fragment --> <dl><dt><b>Examples: </b></dt><dd><a class="el" href="total_variation_8cxx-example.html#a5">total_variation.cxx</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga826a11a3e56ff35a8f3dc38f2c7c9a5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::getAnisotropy </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up directional data for anisotropic regularization. </p>
<p>This routine provides a two-dimensional normalized vector field <img class="formulaInl" alt="$ v $" src="form_99.png"/>, which is normal to edges in the given data, found as the eigenvector of the structure tensor belonging to the largest eigenvalue. <img class="formulaInl" alt="$ v $" src="form_99.png"/> is encoded by a scalar field <img class="formulaInl" alt="$ \varphi $" src="form_100.png"/> of angles, i.e. <img class="formulaInl" alt="$ v(x)=(\cos(\varphi(x)),\sin(\varphi(x)))^\top $" src="form_101.png"/>.</p>
<p>In addition, two scalar fields <img class="formulaInl" alt="$ \alpha $" src="form_102.png"/> and <img class="formulaInl" alt="$ \beta $" src="form_103.png"/> are generated from scalar parameters <img class="formulaInl" alt="$ \alpha_{par}$" src="form_104.png"/> and <img class="formulaInl" alt="$ \beta_{par}$" src="form_105.png"/>, such that </p>
<center> <table class="doxtable">
<tr>
<td><img class="formulaInl" alt="$ \alpha(x)= \alpha_{par}$" src="form_106.png"/> at edges, </td></tr>
<tr>
<td><img class="formulaInl" alt="$ \alpha(x)= \beta_{par}$" src="form_107.png"/> in homogeneous regions, </td></tr>
<tr>
<td><img class="formulaInl" alt="$ \beta(x)=\beta_{par}$" src="form_108.png"/> . </td></tr>
</table>
</center><p><b> Declarations:</b></p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="group__NonLinearDiffusion.html#ga826a11a3e56ff35a8f3dc38f2c7c9a5e">getAnisotropy</a>(MultiArrayView&lt;2,double,stride1&gt; data,</div>
<div class="line">                   MultiArrayView&lt;2,double,stride2&gt; phi,</div>
<div class="line">                   MultiArrayView&lt;2,double,stride3&gt; alpha,</div>
<div class="line">                   MultiArrayView&lt;2,double,stride4&gt; beta,</div>
<div class="line">                   <span class="keywordtype">double</span> alpha_par,</div>
<div class="line">                   <span class="keywordtype">double</span> beta_par,</div>
<div class="line">                   <span class="keywordtype">double</span> sigma_par,</div>
<div class="line">                   <span class="keywordtype">double</span> rho_par,</div>
<div class="line">                   <span class="keywordtype">double</span> K_par);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Output: </p>
<table class="doxtable">
<tr>
<td>Three scalar fields <em>phi</em>, <em>alpha</em> and <em>beta</em>. </td></tr>
</table>
<p>Input: </p>
<table class="doxtable">
<tr>
<td><em>data</em>:</td><td>two-dimensional scalar field. </td></tr>
<tr>
<td><em>alpha_par,beta_par</em>:</td><td>two positive values for setting up the scalar fields alpha and beta </td></tr>
<tr>
<td><em>sigma_par</em>:</td><td>non-negative parameter for presmoothing the data. </td></tr>
<tr>
<td><em>rho_par</em>:</td><td>non-negative parameter for presmoothing the structure tensor. </td></tr>
<tr>
<td><em>K_par</em>:</td><td>positive edge sensitivity parameter. </td></tr>
</table>
<p>(see <a class="el" href="group__NonLinearDiffusion.html#gab03d88e6a6ccf3dd060534d58b8db5b8">anisotropicTotalVariationFilter()</a> and <a class="el" href="group__NonLinearDiffusion.html#ga80e6e77f9e1a94080a3791981bb4fc0c">secondOrderTotalVariationFilter()</a> for usage in an application). </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="total_variation_8cxx-example.html#a6">total_variation.cxx</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gab03d88e6a6ccf3dd060534d58b8db5b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::anisotropicTotalVariationFilter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs Anisotropic Total Variation Regularization. </p>
<p>The algorithm minimizes </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \min_u \int_\Omega \frac{1}{2} (u-f)^2 + \sqrt{\nabla u^\top A \nabla u}\;dx\qquad\qquad(2) \]" src="form_109.png"/>
</p>
<p>where <em> <img class="formulaInl" alt="$ f=f(x)$" src="form_94.png"/> </em> are the noisy data, <em> <img class="formulaInl" alt="$ u=u(x)$" src="form_95.png"/> </em> are the smoothed data,<em> <img class="formulaInl" alt="$ \nabla u $" src="form_110.png"/> </em> is the image gradient in the sense of Total Variation and <em> <img class="formulaInl" alt="$ A $" src="form_111.png"/> </em> is a locally varying symmetric, positive definite 2x2 matrix.</p>
<p>Matrix <em> <img class="formulaInl" alt="$ A $" src="form_111.png"/> </em> is described by providing for each data point a normalized eigenvector (via angle <img class="formulaInl" alt="$ \phi $" src="form_112.png"/>) and two eigenvalues <img class="formulaInl" alt="$ \alpha>0 $" src="form_113.png"/> and <img class="formulaInl" alt="$ \beta>0 $" src="form_114.png"/>.</p>
<p><a class="el" href="group__NonLinearDiffusion.html#ga826a11a3e56ff35a8f3dc38f2c7c9a5e">getAnisotropy()</a> can be use to set up such data <img class="formulaInl" alt="$ \phi,\alpha,\beta $" src="form_115.png"/> by providing a vector field normal to edges.</p>
<p><b> Declarations:</b></p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> str<span class="keywordtype">id</span>e1,<span class="keyword">class</span> str<span class="keywordtype">id</span>e2,<span class="keyword">class</span> str<span class="keywordtype">id</span>e3,<span class="keyword">class</span> str<span class="keywordtype">id</span>e4,<span class="keyword">class</span> str<span class="keywordtype">id</span>e5,<span class="keyword">class</span> str<span class="keywordtype">id</span>e6&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="group__NonLinearDiffusion.html#gab03d88e6a6ccf3dd060534d58b8db5b8">anisotropicTotalVariationFilter</a>(MultiArrayView&lt;2,double,stride1&gt; data,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride2&gt; weight,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride3&gt; phi,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride4&gt; alpha,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride5&gt; beta,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride6&gt; out,</div>
<div class="line">                                       <span class="keywordtype">int</span> steps);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="el" href="group__NonLinearDiffusion.html#gab03d88e6a6ccf3dd060534d58b8db5b8">anisotropicTotalVariationFilter()</a> implements a primal-dual algorithm to solve (2).</p>
<p>Input: </p>
<table class="doxtable">
<tr>
<td><em>data</em>:</td><td>input data to be filtered.  </td></tr>
<tr>
<td><em>steps</em>:</td><td>iteration steps. </td></tr>
<tr>
<td><em>weight</em> :</td><td>a point-wise weight ( <img class="formulaInl" alt="$ \ge 0 $" src="form_98.png"/> ) for the data term. </td></tr>
<tr>
<td><em>phi</em>,<em>alpha</em> and <em>beta</em> :</td><td>describe matrix <img class="formulaInl" alt="$ A $" src="form_111.png"/>, see above. </td></tr>
</table>
<p>Output: </p>
<table class="doxtable">
<tr>
<td><em>out</em> :</td><td>contains filtered data. </td></tr>
</table>
<p><b> Usage:</b></p>
<p>E.g. with a solution-dependent adaptivity cf. [1], by updating the matrix <img class="formulaInl" alt="$ A=A(u)$" src="form_116.png"/> in an outer loop:</p>
<p><b>#include</b> &lt;<a class="el" href="tv__filter_8hxx_source.html">vigra/tv_filter.hxx</a>&gt;</p>
<div class="fragment"><div class="line">MultiArray&lt;2,double&gt; data(Shape2(width,height)); <span class="comment">//to be initialized</span></div>
<div class="line">MultiArray&lt;2,double&gt; out (Shape2(width,height));</div>
<div class="line">MultiArray&lt;2,double&gt; weight(Shape2(width,height));  <span class="comment">//to be initialized</span></div>
<div class="line">MultiArray&lt;2,double&gt; phi  (Shape2(width,height));</div>
<div class="line">MultiArray&lt;2,double&gt; alpha(Shape2(width,height));</div>
<div class="line">MultiArray&lt;2,double&gt; beta (Shape2(width,height));</div>
<div class="line"><span class="keywordtype">double</span> alpha0,beta0,sigma,rho,K;  <span class="comment">//to be initialized</span></div>
<div class="line"><span class="keywordtype">int</span> outer_steps,inner_steps;<span class="comment">//to be initialized</span></div>
<div class="line"></div>
<div class="line">out=data; <span class="comment">// data serves as initial value</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;outer_steps;i++){</div>
<div class="line">  <a class="code" href="group__NonLinearDiffusion.html#ga826a11a3e56ff35a8f3dc38f2c7c9a5e">getAnisotropy</a>(out,phi,alpha,beta,alpha0,beta0,sigma,rho,K);  <span class="comment">// sets phi, alpha, beta</span></div>
<div class="line">  <a class="code" href="group__NonLinearDiffusion.html#gab03d88e6a6ccf3dd060534d58b8db5b8">anisotropicTotalVariationFilter</a>(data,weight,phi,alpha,beta,out,inner_steps);</div>
<div class="line">  }</div>
</div><!-- fragment --><p>[1] Frank Lenzen, Florian Becker, Jan Lellmann, Stefania Petra and Christoph Schn&ouml;rr, A Class of Quasi-Variational Inequalities for Adaptive Image Denoising and Decomposition, Computational Optimization and Applications, Springer, 2012. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="total_variation_8cxx-example.html#a7">total_variation.cxx</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga80e6e77f9e1a94080a3791981bb4fc0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::secondOrderTotalVariationFilter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs Anisotropic Total Variation Regularization. </p>
<p>The algorithm minimizes</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \min_u \int_\Omega \frac{1}{2} (u-f)^2 + \sqrt{\nabla u^\top A \nabla u} + \gamma |Hu|_F\;dx \qquad\qquad (3) \]" src="form_117.png"/>
</p>
<p> where <em> <img class="formulaInl" alt="$ f=f(x)$" src="form_94.png"/> </em> are the noisy data, <em> <img class="formulaInl" alt="$ u=u(x)$" src="form_95.png"/> </em> are the smoothed data,<em> <img class="formulaInl" alt="$ \nabla u $" src="form_110.png"/> </em> is the image gradient in the sense of Total Variation, <em> <img class="formulaInl" alt="$ A $" src="form_111.png"/> </em> is a locally varying symmetric, positive-definite 2x2 matrix and <em> <img class="formulaInl" alt="$ |Hu|_F $" src="form_118.png"/></em> is the Frobenius norm of the Hessian of <img class="formulaInl" alt="$ u $" src="form_119.png"/>.</p>
<p>Matrix <em> <img class="formulaInl" alt="$ A $" src="form_111.png"/> </em> is described by providing for each data point a normalized eigenvector (via angle <img class="formulaInl" alt="$ \phi $" src="form_112.png"/>) and two eigenvalues <img class="formulaInl" alt="$ \alpha>0 $" src="form_113.png"/> and <img class="formulaInl" alt="$ \beta>0 $" src="form_114.png"/>. <a class="el" href="group__NonLinearDiffusion.html#ga826a11a3e56ff35a8f3dc38f2c7c9a5e">getAnisotropy()</a> can be use to set up such data <img class="formulaInl" alt="$ \phi,\alpha, \beta $" src="form_120.png"/> by providing a vector field normal to edges.</p>
<p><img class="formulaInl" alt="$ \gamma>0 $" src="form_121.png"/> is the locally varying regularization parameter for second order.</p>
<p><b> Declarations:</b></p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class </span>stride1,<span class="keyword">class </span>stride2,...,<span class="keyword">class </span>stride9&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="group__NonLinearDiffusion.html#ga80e6e77f9e1a94080a3791981bb4fc0c">secondOrderTotalVariationFilter</a>(MultiArrayView&lt;2,double,stride1&gt; data,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride2&gt; weight,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride3&gt; phi,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride4&gt; alpha,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride5&gt; beta,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride6&gt; <a class="code" href="group__MathFunctions.html#ga441c9e4bf9f952c0fe94836634bcf976">gamma</a>,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride7&gt; xedges,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride8&gt; yedges,</div>
<div class="line">                                       MultiArrayView&lt;2,double,stride9&gt; out,</div>
<div class="line">                                       <span class="keywordtype">int</span> steps);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="el" href="group__NonLinearDiffusion.html#ga80e6e77f9e1a94080a3791981bb4fc0c">secondOrderTotalVariationFilter()</a> implements a primal-dual algorithm to solve (3).</p>
<p>Input: </p>
<table class="doxtable">
<tr>
<td><em>data</em>: </td><td>the input data to be filtered.  </td></tr>
<tr>
<td><em>steps</em> : </td><td>number of iteration steps. </td></tr>
<tr>
<td><em>out</em> : </td><td>contains the filtered data. </td></tr>
<tr>
<td><em>weight</em> : </td><td>point-wise weight ( <img class="formulaInl" alt="$ \ge 0$" src="form_122.png"/> ) for the data term. </td></tr>
<tr>
<td><em>phi</em>,<em>alpha</em>,<em>beta</em>: </td><td>describe matrix <img class="formulaInl" alt="$ A$" src="form_123.png"/>, see above. </td></tr>
<tr>
<td><em> xedges </em> and <em> yedges </em>: </td><td>binary arrays indicating the presence of horizontal (between (x,y) and (x+1,y)) and vertical edges (between (x,y) and (x,y+1)). These data are considered in the calculation of <img class="formulaInl" alt="$ Hu$" src="form_124.png"/>, such that finite differences across edges are artificially set to zero to avoid second order smoothing over edges. </td></tr>
</table>
<p><b> Usage:</b></p>
<p>E.g. with a solution-dependent adaptivity (cf.[1]), by updating the matrix <img class="formulaInl" alt="$ A=A(u)$" src="form_116.png"/> in an outer loop:</p>
<p><b>#include</b> &lt;<a class="el" href="tv__filter_8hxx_source.html">vigra/tv_filter.hxx</a>&gt;</p>
<div class="fragment"><div class="line">MultiArray&lt;2,double&gt; data(Shape2(width,height)); <span class="comment">//to be initialized</span></div>
<div class="line">MultiArray&lt;2,double&gt; out(Shape2(width,height));</div>
<div class="line">MultiArray&lt;2,double&gt; weight(Shape2(width,height))); <span class="comment">//to be initialized</span></div>
<div class="line">MultiArray&lt;2,double&gt; phi(Shape2(width,height);</div>
<div class="line">MultiArray&lt;2,double&gt; alpha(Shape2(width,height);</div>
<div class="line">MultiArray&lt;2,double&gt; beta(Shape2(width,height));</div>
<div class="line">MultiArray&lt;2,double&gt; <a class="code" href="group__MathFunctions.html#ga441c9e4bf9f952c0fe94836634bcf976">gamma</a>(Shape2(width,height));  <span class="comment">//to be initialized</span></div>
<div class="line">MultiArray&lt;2,double&gt; xedges(Shape2(width,height));  <span class="comment">//to be initialized</span></div>
<div class="line">MultiArray&lt;2,double&gt; yedges(Shape2(width,height));  <span class="comment">//to be initialized</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">double</span> alpha0,beta0,sigma,rho,K;  <span class="comment">//to be initialized</span></div>
<div class="line"><span class="keywordtype">int</span> outer_steps,inner_steps;<span class="comment">//to be initialized</span></div>
<div class="line"></div>
<div class="line">out=data; <span class="comment">// data serves as initial value</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;outer_steps;i++){</div>
<div class="line"></div>
<div class="line">  <a class="code" href="group__NonLinearDiffusion.html#ga826a11a3e56ff35a8f3dc38f2c7c9a5e">getAnisotropy</a>(out,phi,alpha,beta,alpha0,beta0,sigma,rho,K);  <span class="comment">// sets phi, alpha, beta</span></div>
<div class="line">  <a class="code" href="group__NonLinearDiffusion.html#ga80e6e77f9e1a94080a3791981bb4fc0c">secondOrderTotalVariationFilter</a>(data,weight,phi,alpha,beta,<a class="code" href="group__MathFunctions.html#ga441c9e4bf9f952c0fe94836634bcf976">gamma</a>,xedges,yedges,out,inner_steps);</div>
<div class="line">}</div>
</div><!-- fragment --><p>[1] Frank Lenzen, Florian Becker, Jan Lellmann, Stefania Petra and Christoph Schn&ouml;rr, A Class of Quasi-Variational Inequalities for Adaptive Image Denoising and Decomposition, Computational Optimization and Applications, Springer, 2012. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="total_variation_8cxx-example.html#a12">total_variation.cxx</a>.</dd>
</dl>
</div>
</div>
</div><!-- contents -->
<!-- footer.html -->
<p>
<table border=0 cellspacing=0 width="100%"  bgcolor="#e0d0a0" cellpadding=5>
<tr>
<td>
<p>
<i>&copy; <A HREF="http://hci.iwr.uni-heidelberg.de/people/ukoethe/">Ullrich K&ouml;the</A>     (<A
HREF="mailto:ullrich.koethe@iwr.uni-heidelberg.de">ullrich.koethe@iwr.uni-heidelberg.de</A>)</i> <br>
<i><A HREF="http://hci.iwr.uni-heidelberg.de/">
Heidelberg Collaboratory for Image Processing</a>,
University of Heidelberg, Germany</i>
<td>
<p align=right>
<I>html generated using <A HREF="http://www.doxygen.org">doxygen</A> and <A HREF="http://www.python.org">Python</A></I>
<br>
<i>
vigra 1.11.0 (Fri May 19 2017)
</i>
</tr>
</table>
</BODY>
</HTML>
