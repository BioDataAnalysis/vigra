<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><TITLE>vigra - Fast Fourier Transform</TITLE>
<link rel=stylesheet type="text/css" href="vigra.css">
<link rel=stylesheet type="text/css" href="vigra_1_8_2.css">
<link rel="shortcut icon" href="vigra-icon.ico" />
<script type="text/javascript">
function toggleHiddenDocumentation( textID, toggleID, toggleMessage )
{
	if( document.getElementById(textID).style.display == 'none' )
    {
		document.getElementById(textID).style.display = 'block';
        document.getElementById(toggleID).innerHTML = "hide " + toggleMessage;
    }
    else
    {
		document.getElementById(textID).style.display = 'none';
        document.getElementById(toggleID).innerHTML = "show " + toggleMessage;
	}
    return false;
}
</script>
<script>
var runOnLoad=function(c,o,d,e){function x(){for(e=1;c.length;)c.shift()()}o[d]?(document[d]('DOMContentLoaded',x,0),o[d]('load',x,0)):o.attachEvent('onload',x);return function(t){e?o.setTimeout(t,0):c.push(t)}}([],window,'addEventListener');
</script>
<script type="text/javascript" src="documents/CollapsibleLists.js"></script>
<script type="text/javascript">
    runOnLoad(function(){ CollapsibleLists.apply(); });
</script>
<style type="text/css">
.collapsibleList li.collapsibleListOpen{
  list-style-image:url('documents/pfeil.gif');
  cursor:pointer;
}
.collapsibleList li.collapsibleListClosed{
  list-style-image:url('documents/bullet.gif');
  cursor:pointer;
}
.collapsibleList li.lastItem{
  list-style-image:url('documents/diamond.gif');
}
</style>
</head>
<body  bgcolor="#f8f0e0" link="#0040b0" vlink="#a00040">
<basefont face="Helvetica,Arial,sans-serif" size=3>
<p align=right>
[ <a href="http://ukoethe.github.io/vigra/">VIGRA Homepage</a> |
 <a href="functionindex.html">Function Index</a> |
 <a href="classes.html">Class Index</a> |
 <a href="namespaces.html">Namespaces</a> |
 <a href="files.html">File List</a> |
 <a href="index.html">Main Page</a> ]
</p>
<!-- Generated by Doxygen 1.8.6 -->
</div><!-- top -->
<div class="contents">
<table class="main_heading">
<tr>
<td align=left>
<A HREF ="#_details" ><IMG BORDER=0 ALT="details" title="Detailed Description" SRC="documents/pfeilGross.gif"></A>
</td>
<td width="100%">Fast Fourier Transform
</td>
<td align=right><a href="http://hci.iwr.uni-heidelberg.de/vigra/"><IMG border=0 ALT="VIGRA" SRC="documents/vigra.gif" title="VIGRA Homepage"></a></td></tr>
</table><p>

<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvigra_1_1FFTWConvolvePlan.html">FFTWConvolvePlan&lt; N, Real &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvigra_1_1FFTWCorrelatePlan.html">FFTWCorrelatePlan&lt; N, Real &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvigra_1_1FFTWPlan.html">FFTWPlan&lt; N, Real &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad51931cfe91ece316e28ff9d7ff28377"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:gad51931cfe91ece316e28ff9d7ff28377"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter</a> (...)</td></tr>
<tr class="memdesc:gad51931cfe91ece316e28ff9d7ff28377"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a filter (defined in the frequency domain) to an image.  <a href="#gad51931cfe91ece316e28ff9d7ff28377">More...</a><br/></td></tr>
<tr class="separator:gad51931cfe91ece316e28ff9d7ff28377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga615ea159a1ac4328600ee44cbaa9a343"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:ga615ea159a1ac4328600ee44cbaa9a343"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343">applyFourierFilterFamily</a> (...)</td></tr>
<tr class="memdesc:ga615ea159a1ac4328600ee44cbaa9a343"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply an array of filters (defined in the frequency domain) to an image.  <a href="#ga615ea159a1ac4328600ee44cbaa9a343">More...</a><br/></td></tr>
<tr class="separator:ga615ea159a1ac4328600ee44cbaa9a343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafbea828444f49163293b1d81fcd05da8"><td class="memTemplParams" colspan="2">template&lt;class T , int N&gt; </td></tr>
<tr class="memitem:gafbea828444f49163293b1d81fcd05da8"><td class="memTemplItemLeft" align="right" valign="top">TinyVector&lt; T, N &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gafbea828444f49163293b1d81fcd05da8">fftwCorrespondingShapeR2C</a> (TinyVector&lt; T, N &gt; shape)</td></tr>
<tr class="memdesc:gafbea828444f49163293b1d81fcd05da8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find frequency domain shape for a R2C Fourier transform.  <a href="#gafbea828444f49163293b1d81fcd05da8">More...</a><br/></td></tr>
<tr class="separator:gafbea828444f49163293b1d81fcd05da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd9dce5cef45cda228466002d00a0666"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:gadd9dce5cef45cda228466002d00a0666"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a> (...)</td></tr>
<tr class="memdesc:gadd9dce5cef45cda228466002d00a0666"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute forward and inverse Fourier transforms.  <a href="#gadd9dce5cef45cda228466002d00a0666">More...</a><br/></td></tr>
<tr class="separator:gadd9dce5cef45cda228466002d00a0666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga478712099cf479694c81ccc5918aca73"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:ga478712099cf479694c81ccc5918aca73"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a> (...)</td></tr>
<tr class="memdesc:ga478712099cf479694c81ccc5918aca73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute inverse Fourier transforms.  <a href="#ga478712099cf479694c81ccc5918aca73">More...</a><br/></td></tr>
<tr class="separator:ga478712099cf479694c81ccc5918aca73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga99f1f190a25ea2dbdc78c4e18c25699d"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:ga99f1f190a25ea2dbdc78c4e18c25699d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#ga99f1f190a25ea2dbdc78c4e18c25699d">fourierTransformReal</a> (...)</td></tr>
<tr class="memdesc:ga99f1f190a25ea2dbdc78c4e18c25699d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Real Fourier transforms for even and odd boundary conditions (aka. cosine and sine transforms).  <a href="#ga99f1f190a25ea2dbdc78c4e18c25699d">More...</a><br/></td></tr>
<tr class="separator:ga99f1f190a25ea2dbdc78c4e18c25699d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaecb29642aab8a911b4f53e289d31e5e5"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:gaecb29642aab8a911b4f53e289d31e5e5"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">moveDCToCenter</a> (...)</td></tr>
<tr class="memdesc:gaecb29642aab8a911b4f53e289d31e5e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rearrange the quadrants of a Fourier image so that the origin is in the image center.  <a href="#gaecb29642aab8a911b4f53e289d31e5e5">More...</a><br/></td></tr>
<tr class="separator:gaecb29642aab8a911b4f53e289d31e5e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaee27c376079af99e8e2148e7d23ffbbb"><td class="memTemplParams" colspan="2">template&lt;... &gt; </td></tr>
<tr class="memitem:gaee27c376079af99e8e2148e7d23ffbbb"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft</a> (...)</td></tr>
<tr class="memdesc:gaee27c376079af99e8e2148e7d23ffbbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rearrange the quadrants of a Fourier image so that the origin is in the image's upper left.  <a href="#gaee27c376079af99e8e2148e7d23ffbbb">More...</a><br/></td></tr>
<tr class="separator:gaee27c376079af99e8e2148e7d23ffbbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="_details" id="details"></a><h2 class="details_section">Detailed Description</h2>
<p>VIGRA provides a powerful C++ API for the popular <a href="http://www.fftw.org/">FFTW library</a> for fast Fourier transforms. There are two versions of the API: an older one based on image iterators (and therefore restricted to 2D) and a new one based on <a class="el" href="classvigra_1_1MultiArrayView.html">MultiArrayView</a> that works for arbitrary dimensions. In addition, the functions <a class="el" href="group__ConvolutionFilters.html#gaaf819a613a16ee9807d69ecb2d91b2ae">convolveFFT()</a> and <a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter()</a> provide an easy-to-use interface for FFT-based convolution, a major application of Fourier transforms. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaecb29642aab8a911b4f53e289d31e5e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::moveDCToCenter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rearrange the quadrants of a Fourier image so that the origin is in the image center. </p>
<p>FFTW produces fourier images where the DC component (origin of fourier space) is located in the upper left corner of the image. The quadrants are placed like this (using a 4x4 image for example):</p>
<div class="fragment"><div class="line">DC 4 3 3</div>
<div class="line"> 4 4 3 3</div>
<div class="line"> 1 1 2 2</div>
<div class="line"> 1 1 2 2</div>
</div><!-- fragment --><p>After applying the function, the quadrants are at their usual places:</p>
<div class="fragment"><div class="line">2 2  1 1</div>
<div class="line">2 2  1 1</div>
<div class="line">3 3 DC 4</div>
<div class="line">3 3  4 4</div>
</div><!-- fragment --><p>This transformation can be reversed by <a class="el" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft()</a>. Note that the 2D versions of this transformation must not be executed in place - input and output images must be different. In contrast, the nD version (with <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray. ">MultiArrayView</a> argument) always works in-place.</p>
<p><b> Declarations:</b></p>
<p>use <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray. ">MultiArrayView</a> (this works in-place, with arbitrary dimension N): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> T, <span class="keyword">class</span> Str<span class="keywordtype">id</span>e&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">moveDCToCenter</a>(MultiArrayView&lt;N, T, Stride&gt; a);</div>
<div class="line">}</div>
</div><!-- fragment --><p>pass iterators explicitly (2D only, not in-place): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">moveDCToCenter</a>(SrcImageIterator src_upperleft,</div>
<div class="line">                           SrcImageIterator src_lowerright, SrcAccessor sa,</div>
<div class="line">                           DestImageIterator dest_upperleft, DestAccessor da);</div>
<div class="line">}</div>
</div><!-- fragment --><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> (2D only, not in-place): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">moveDCToCenter</a>(</div>
<div class="line">        triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,</div>
<div class="line">        pair&lt;DestImageIterator, DestAccessor&gt; dest);</div>
<div class="line">}</div>
</div><!-- fragment --><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt; (for 2D variants) <br/>
 <b>#include</b> &lt;<a class="el" href="multi__fft_8hxx_source.html">vigra/multi_fft.hxx</a>&gt; (for nD variants) <br/>
 Namespace: vigra</p>
<div class="fragment"><div class="line"><a class="code" href="classvigra_1_1BasicImage.html">vigra::FFTWComplexImage</a> spatial(width,height), fourier(width,height);</div>
<div class="line">... <span class="comment">// fill image with data</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// create a plan with estimated performance optimization</span></div>
<div class="line">fftw_plan forwardPlan = fftw_plan_dft_2d(height, width,</div>
<div class="line">                            (fftw_complex *)spatial.begin(), (fftw_complex *)fourier.begin(),</div>
<div class="line">                            FFTW_FORWARD, FFTW_ESTIMATE );</div>
<div class="line"><span class="comment">// calculate FFT</span></div>
<div class="line">fftw_execute(forwardPlan);</div>
<div class="line"></div>
<div class="line"><a class="code" href="classvigra_1_1BasicImage.html">vigra::FFTWComplexImage</a> rearrangedFourier(width, height);</div>
<div class="line"><a class="code" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">moveDCToCenter</a>(srcImageRange(fourier), destImage(rearrangedFourier));</div>
<div class="line"></div>
<div class="line"><span class="comment">// delete the plan</span></div>
<div class="line">fftw_destroy_plan(forwardPlan);</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaee27c376079af99e8e2148e7d23ffbbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::moveDCToUpperLeft </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rearrange the quadrants of a Fourier image so that the origin is in the image's upper left. </p>
<p>This function is the inversion of <a class="el" href="group__FourierTransform.html#gaecb29642aab8a911b4f53e289d31e5e5">moveDCToCenter()</a>. See there for a detailed description and usage examples.</p>
<p><b> Declarations:</b></p>
<p>use <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray. ">MultiArrayView</a> (this works in-place, with arbitrary dimension N): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> T, <span class="keyword">class</span> Str<span class="keywordtype">id</span>e&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft</a>(MultiArrayView&lt;N, T, Stride&gt; a);</div>
<div class="line">}</div>
</div><!-- fragment --><p>pass iterators explicitly (2D only, not in-place): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft</a>(SrcImageIterator src_upperleft,</div>
<div class="line">                           SrcImageIterator src_lowerright, SrcAccessor sa,</div>
<div class="line">                           DestImageIterator dest_upperleft, DestAccessor da);</div>
<div class="line">}</div>
</div><!-- fragment --><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> (2D only, not in-place): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft</a>(</div>
<div class="line">        triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,</div>
<div class="line">        pair&lt;DestImageIterator, DestAccessor&gt; dest);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gadd9dce5cef45cda228466002d00a0666"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::fourierTransform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute forward and inverse Fourier transforms. </p>
<p>The array referring to the spatial domain (i.e. the input in a forward transform, and the output in an inverse transform) may be scalar or complex. The array representing the frequency domain (i.e. output for forward transform, input for inverse transform) must always be complex.</p>
<p>The new implementations (those using <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray. ">MultiArrayView</a> arguments) perform a normalized transform, whereas the old ones (using 2D iterators or argument objects) perform an un-normalized transform (i.e. the result of the inverse transform is scaled by the number of pixels).</p>
<p>In general, input and output arrays must have the same shape, with the exception of the special <a href="http://www.fftw.org/doc/Multi_002dDimensional-DFTs-of-Real-Data.html">R2C and C2R modes</a> defined by FFTW.</p>
<p>The R2C transform reduces the redundancy in the Fourier representation of a real-valued signal: Since the Fourier representation of a real signal is symmetric, about half of the Fourier coefficients can simply be dropped. By convention, this reduction is applied to the first (innermost) dimension, such that <code>fourier.shape(0) == spatial.shape(0)/2 + 1</code> holds. The correct frequency domain shape can be conveniently computed by means of the function <a class="el" href="group__FourierTransform.html#gafbea828444f49163293b1d81fcd05da8">fftwCorrespondingShapeR2C()</a>.</p>
<p>Note that your program must always link against <code>libfftw3</code>. If you want to compute Fourier transforms for <code>float</code> or <code>long double</code> arrays, you must <em>additionally</em> link against <code>libfftw3f</code> and <code>libfftw3l</code> respectively. (Old-style functions only support <code>double</code>).</p>
<p>The Fourier transform functions internally create <a href="http://www.fftw.org/doc/Using-Plans.html">FFTW plans</a> which control the algorithm details. The plans are creates with the flag <code>FFTW_ESTIMATE</code>, i.e. optimal settings are guessed or read from saved "wisdom" files. If you need more control over planning, you can use the class <a class="el" href="classvigra_1_1FFTWPlan.html">FFTWPlan</a>.</p>
<p><b> Declarations:</b></p>
<p>use complex-valued <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray. ">MultiArrayView</a> arguments (this works for arbitrary dimension N): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> Real, <span class="keyword">class</span> C1, <span class="keyword">class</span> C2&gt;</div>
<div class="line">    <span class="keywordtype">void</span> </div>
<div class="line">    <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a>(MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C1&gt; in, </div>
<div class="line">                     MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C2&gt; out);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> Real, <span class="keyword">class</span> C1, <span class="keyword">class</span> C2&gt;</div>
<div class="line">    <span class="keywordtype">void</span> </div>
<div class="line">    <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a>(MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C1&gt; in, </div>
<div class="line">                            MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C2&gt; out);</div>
<div class="line">}</div>
</div><!-- fragment --><p>use real-valued <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray. ">MultiArrayView</a> in the spatial domain, complex-valued <a class="el" href="classvigra_1_1MultiArrayView.html" title="Base class for, and view to, vigra::MultiArray. ">MultiArrayView</a> in the frequency domain (this works for arbitrary dimension N, and also supports the R2C and C2R transform, depending on the array shape in the frequency domain): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> Real, <span class="keyword">class</span> C1, <span class="keyword">class</span> C2&gt;</div>
<div class="line">    <span class="keywordtype">void</span> </div>
<div class="line">    <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a>(MultiArrayView&lt;N, Real, C1&gt; in, </div>
<div class="line">                     MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C2&gt; out);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> N, <span class="keyword">class</span> Real, <span class="keyword">class</span> C1, <span class="keyword">class</span> C2&gt;</div>
<div class="line">    <span class="keywordtype">void</span> </div>
<div class="line">    <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a>(MultiArrayView&lt;N, FFTWComplex&lt;Real&gt;, C1&gt; in, </div>
<div class="line">                            MultiArrayView&lt;N, Real, C2&gt; out);</div>
<div class="line">}</div>
</div><!-- fragment --><p>pass iterators explicitly (2D only, double only): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a>(SrcImageIterator srcUpperLeft,</div>
<div class="line">                          SrcImageIterator srcLowerRight, SrcAccessor src,</div>
<div class="line">                          <a class="code" href="classvigra_1_1BasicImage.html#a94032047b4445f0822d7508a3ffff034">FFTWComplexImage::traverser</a> destUpperLeft, <a class="code" href="classvigra_1_1BasicImage.html#a28a41780fa37a19501034e86747e45b7">FFTWComplexImage::Accessor</a> dest);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a>(<a class="code" href="classvigra_1_1BasicImage.html#a0e56cb0f6842d3f9f30361ca669a3b15">FFTWComplexImage::const_traverser</a> sul,</div>
<div class="line">                            <a class="code" href="classvigra_1_1BasicImage.html#a0e56cb0f6842d3f9f30361ca669a3b15">FFTWComplexImage::const_traverser</a> slr, <a class="code" href="classvigra_1_1BasicImage.html#a65676f5294c2039d907f09346c4c2b4c">FFTWComplexImage::ConstAccessor</a> src,</div>
<div class="line">                            <a class="code" href="classvigra_1_1BasicImage.html#a94032047b4445f0822d7508a3ffff034">FFTWComplexImage::traverser</a> dul, <a class="code" href="classvigra_1_1BasicImage.html#a28a41780fa37a19501034e86747e45b7">FFTWComplexImage::Accessor</a> dest)</div>
<div class="line">}</div>
</div><!-- fragment --><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> (2D only, double only): </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a>(triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,</div>
<div class="line">                          pair&lt;FFTWComplexImage::traverser, FFTWComplexImage::Accessor&gt; dest);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    <a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a>(triple&lt;<a class="code" href="classvigra_1_1BasicImage.html#a0e56cb0f6842d3f9f30361ca669a3b15">FFTWComplexImage::const_traverser</a>,</div>
<div class="line">                                   <a class="code" href="classvigra_1_1BasicImage.html#a0e56cb0f6842d3f9f30361ca669a3b15">FFTWComplexImage::const_traverser</a>, <a class="code" href="classvigra_1_1BasicImage.html#a65676f5294c2039d907f09346c4c2b4c">FFTWComplexImage::ConstAccessor</a>&gt; src,</div>
<div class="line">                            pair&lt;FFTWComplexImage::traverser, FFTWComplexImage::Accessor&gt; dest);</div>
<div class="line">}</div>
</div><!-- fragment --><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt; (old-style 2D variants)<br/>
 <b>#include</b> &lt;<a class="el" href="multi__fft_8hxx_source.html">vigra/multi_fft.hxx</a>&gt; (new-style nD variants)<br/>
 Namespace: vigra</p>
<p>old-style example (using FFTWComplexImage): </p>
<div class="fragment"><div class="line"><span class="comment">// compute complex Fourier transform of a real image, old-style implementation</span></div>
<div class="line"><a class="code" href="classvigra_1_1BasicImage.html">vigra::DImage</a> src(w, h);</div>
<div class="line"><a class="code" href="classvigra_1_1BasicImage.html">vigra::FFTWComplexImage</a> fourier(w, h);</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a>(srcImageRange(src), destImage(fourier));</div>
<div class="line"></div>
<div class="line"><span class="comment">// compute inverse Fourier transform</span></div>
<div class="line"><span class="comment">// note that both source and destination image must be of type vigra::FFTWComplexImage</span></div>
<div class="line"><a class="code" href="classvigra_1_1BasicImage.html">vigra::FFTWComplexImage</a> inverseFourier(w, h);</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a>(srcImageRange(fourier), destImage(inverseFourier));</div>
</div><!-- fragment --><p>new-style examples (using <a class="el" href="classvigra_1_1MultiArray.html" title="Main MultiArray class containing the memory management. ">MultiArray</a>): </p>
<div class="fragment"><div class="line"><span class="comment">// compute Fourier transform of a real array, using the R2C algorithm</span></div>
<div class="line">MultiArray&lt;2, double&gt; src(Shape2(w, h));</div>
<div class="line">MultiArray&lt;2, FFTWComplex&lt;double&gt; &gt; fourier(<a class="code" href="group__FourierTransform.html#gafbea828444f49163293b1d81fcd05da8">fftwCorrespondingShapeR2C</a>(src.shape()));</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a>(src, fourier);</div>
<div class="line"></div>
<div class="line"><span class="comment">// compute inverse Fourier transform, using the C2R algorithm</span></div>
<div class="line">MultiArray&lt;2, double&gt; dest(src.shape());</div>
<div class="line"><a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a>(fourier, dest);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">// compute Fourier transform of a real array with standard algorithm</span></div>
<div class="line">MultiArray&lt;2, double&gt; src(Shape2(w, h));</div>
<div class="line">MultiArray&lt;2, FFTWComplex&lt;double&gt; &gt; fourier(src.shape());</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform</a>(src, fourier);</div>
<div class="line"></div>
<div class="line"><span class="comment">// compute inverse Fourier transform, using the C2R algorithm</span></div>
<div class="line">MultiArray&lt;2, double&gt; dest(src.shape());</div>
<div class="line"><a class="code" href="group__FourierTransform.html#ga478712099cf479694c81ccc5918aca73">fourierTransformInverse</a>(fourier, dest);</div>
</div><!-- fragment --><p> Complex input arrays are handled in the same way. </p>

</div>
</div>
<a class="anchor" id="ga478712099cf479694c81ccc5918aca73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::fourierTransformInverse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute inverse Fourier transforms. </p>
<p>See <a class="el" href="group__FourierTransform.html#gadd9dce5cef45cda228466002d00a0666">fourierTransform()</a> for details. </p>

</div>
</div>
<a class="anchor" id="gad51931cfe91ece316e28ff9d7ff28377"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::applyFourierFilter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a filter (defined in the frequency domain) to an image. </p>
<p>After transferring the image into the frequency domain, it is multiplied pixel-wise with the filter and transformed back. The result is put into the given destination image which must have the right size. The result will be normalized to compensate for the two FFTs.</p>
<p>If the destination image is scalar, only the real part of the result image is retained. In this case, you are responsible for choosing a filter image which ensures a zero imaginary part of the result (e.g. use a real, even symmetric filter image, or a purely imaginary, odd symmetric one).</p>
<p>The DC entry of the filter must be in the upper left, which is the position where FFTW expects it (see <a class="el" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft()</a>).</p>
<p>See also <a class="el" href="group__ConvolutionFilters.html#gaaf819a613a16ee9807d69ecb2d91b2ae">convolveFFT()</a> for corresponding functionality on the basis of the <a class="el" href="classvigra_1_1MultiArrayView.html">MultiArrayView</a> interface.</p>
<p><b> Declarations:</b></p>
<p>pass 2D array views: </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>FilterImageIterator, <span class="keyword">class </span>FilterAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter</a>(SrcImageIterator srcUpperLeft,</div>
<div class="line">                            SrcImageIterator srcLowerRight, SrcAccessor sa,</div>
<div class="line">                            FilterImageIterator filterUpperLeft, FilterAccessor fa,</div>
<div class="line">                            DestImageIterator destUpperLeft, DestAccessor da);</div>
<div class="line">}</div>
</div><!-- fragment --><p>pass <a class="el" href="group__ImageIterators.html">Image Iterators</a> and <a class="el" href="group__DataAccessors.html">Data Accessors</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>FilterImageIterator, <span class="keyword">class </span>FilterAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter</a>(SrcImageIterator srcUpperLeft,</div>
<div class="line">                            SrcImageIterator srcLowerRight, SrcAccessor sa,</div>
<div class="line">                            FilterImageIterator filterUpperLeft, FilterAccessor fa,</div>
<div class="line">                            DestImageIterator destUpperLeft, DestAccessor da);</div>
<div class="line">}</div>
</div><!-- fragment --><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcImageIterator, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>FilterImageIterator, <span class="keyword">class </span>FilterAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestImageIterator, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter</a>(triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,</div>
<div class="line">                            pair&lt;FilterImageIterator, FilterAccessor&gt; filter,</div>
<div class="line">                            pair&lt;DestImageIterator, DestAccessor&gt; dest);</div>
<div class="line">}</div>
</div><!-- fragment --><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><div class="line"><span class="comment">// create a Gaussian filter in Fourier space</span></div>
<div class="line"><a class="code" href="classvigra_1_1BasicImage.html">vigra::FImage</a> gaussFilter(w, h), filter(w, h);</div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> y=0; y&lt;h; ++y)</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x=0; x&lt;w; ++x)</div>
<div class="line">    {</div>
<div class="line">        xx = float(x - w / 2) / w;</div>
<div class="line">        yy = float(y - h / 2) / h;</div>
<div class="line"></div>
<div class="line">        gaussFilter(x,y) = <a class="code" href="group__LinearAlgebraFunctions.html#ga2a9e01ae7ae7b39a618e9f4a6afaee5b">std::exp</a>(-(xx*xx + yy*yy) / 2.0 * scale);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="comment">// applyFourierFilter() expects the filter&#39;s DC in the upper left</span></div>
<div class="line"><a class="code" href="group__FourierTransform.html#gaee27c376079af99e8e2148e7d23ffbbb">moveDCToUpperLeft</a>(srcImageRange(gaussFilter), destImage(filter));</div>
<div class="line"></div>
<div class="line"><a class="code" href="classvigra_1_1BasicImage.html">vigra::FFTWComplexImage</a> result(w, h);</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">vigra::applyFourierFilter</a>(srcImageRange(image), srcImage(filter), result);</div>
</div><!-- fragment --><p>For inspection of the result, <a class="el" href="classvigra_1_1FFTWMagnitudeAccessor.html">FFTWMagnitudeAccessor</a> might be useful. If you want to apply the same filter repeatedly, it may be more efficient to use the FFTW functions directly with FFTW plans optimized for good performance. </p>

</div>
</div>
<a class="anchor" id="ga615ea159a1ac4328600ee44cbaa9a343"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::applyFourierFilterFamily </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply an array of filters (defined in the frequency domain) to an image. </p>
<p>This provides the same functionality as <a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter()</a>, but applying several filters at once allows to avoid repeated Fourier transforms of the source image.</p>
<p>Filters and result images must be stored in <a class="el" href="classvigra_1_1ImageArray.html">vigra::ImageArray</a> data structures. In contrast to <a class="el" href="group__FourierTransform.html#gad51931cfe91ece316e28ff9d7ff28377">applyFourierFilter()</a>, this function adjusts the size of the result images and the the length of the array.</p>
<p><b> Declarations:</b></p>
<p>pass 2D array views: </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor, <span class="keyword">class</span> FilterType&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343">applyFourierFilterFamily</a>(SrcImageIterator srcUpperLeft,</div>
<div class="line">                                  SrcImageIterator srcLowerRight, SrcAccessor sa,</div>
<div class="line">                                  <span class="keyword">const</span> ImageArray&lt;FilterType&gt; &amp;filters,</div>
<div class="line">                                  ImageArray&lt;FFTWComplexImage&gt; &amp;results)</div>
<div class="line">}</div>
</div><!-- fragment --><p>pass <a class="el" href="group__ImageIterators.html">Image Iterators</a> and <a class="el" href="group__DataAccessors.html">Data Accessors</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor, <span class="keyword">class</span> FilterType&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343">applyFourierFilterFamily</a>(SrcImageIterator srcUpperLeft,</div>
<div class="line">                                  SrcImageIterator srcLowerRight, SrcAccessor sa,</div>
<div class="line">                                  <span class="keyword">const</span> ImageArray&lt;FilterType&gt; &amp;filters,</div>
<div class="line">                                  ImageArray&lt;FFTWComplexImage&gt; &amp;results)</div>
<div class="line">}</div>
</div><!-- fragment --><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> SrcImageIterator, <span class="keyword">class</span> SrcAccessor, <span class="keyword">class</span> FilterType&gt;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343">applyFourierFilterFamily</a>(triple&lt;SrcImageIterator, SrcImageIterator, SrcAccessor&gt; src,</div>
<div class="line">                                  <span class="keyword">const</span> ImageArray&lt;FilterType&gt; &amp;filters,</div>
<div class="line">                                  ImageArray&lt;FFTWComplexImage&gt; &amp;results)</div>
<div class="line">}</div>
</div><!-- fragment --><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><div class="line"><span class="comment">// assuming the presence of a real-valued image named &quot;image&quot; to</span></div>
<div class="line"><span class="comment">// be filtered in this example</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classvigra_1_1ImageArray.html">vigra::ImageArray&lt;vigra::FImage&gt;</a> filters(16, image.size());</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;filters.size(); i++)</div>
<div class="line">     <span class="comment">// create some meaningful filters here</span></div>
<div class="line">     createMyFilterOfScale(i, destImage(filters[i]));</div>
<div class="line"></div>
<div class="line"><a class="code" href="classvigra_1_1ImageArray.html">vigra::ImageArray&lt;vigra::FFTWComplexImage&gt;</a> results();</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__FourierTransform.html#ga615ea159a1ac4328600ee44cbaa9a343">vigra::applyFourierFilterFamily</a>(srcImageRange(image), filters, results);</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga99f1f190a25ea2dbdc78c4e18c25699d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vigra::fourierTransformReal </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Real Fourier transforms for even and odd boundary conditions (aka. cosine and sine transforms). </p>
<p>If the image is real and has even symmetry, its Fourier transform is also real and has even symmetry. The Fourier transform of a real image with odd symmetry is imaginary and has odd symmetry. In either case, only about a quarter of the pixels need to be stored because the rest can be calculated from the symmetry properties. This is especially useful, if the original image is implicitly assumed to have reflective or anti-reflective boundary conditions. Then the "negative" pixel locations are defined as</p>
<div class="fragment"><div class="line"><a class="code" href="group__MathFunctions.html#ga3cf86b8d2300cd08b69024eb89f90115">even</a> (reflective boundary conditions):      f[-x] = f[x]     (x = 1,...,N-1)</div>
<div class="line"><a class="code" href="group__MathFunctions.html#ga48f661149941ebaa90ddd99ee5eee145">odd</a> (anti-reflective boundary conditions):  f[-1] = 0</div>
<div class="line">                                            f[-x] = -f[x-2]  (x = 2,...,N-1)</div>
</div><!-- fragment --><p>end similar at the other boundary (see the FFTW documentation for details). This has the advantage that more efficient Fourier transforms that use only real numbers can be implemented. These are also known as cosine and sine transforms respectively.</p>
<p>If you use the odd transform it is important to note that in the Fourier domain, the DC component is always zero and is therefore dropped from the data structure. This means that index 0 in an odd symmetric Fourier domain image refers to the <em>first</em> harmonic. This is especially important if an image is first cosine transformed (even symmetry), then in the Fourier domain multiplied with an odd symmetric filter (e.g. a first derivative) and finally transformed back to the spatial domain with a sine transform (odd symmetric). For this to work properly the image must be shifted left or up by one pixel (depending on whether the x- or y-axis is odd symmetric) before the inverse transform can be applied. (see example below).</p>
<p>The real Fourier transform functions are named <code>fourierTransformReal??</code> where the questions marks stand for either <code>E</code> or <code>O</code> indicating whether the x- and y-axis is to be transformed using even or odd symmetry. The same functions can be used for both the forward and inverse transforms, only the normalization changes. For signal processing, the following normalization factors are most appropriate:</p>
<div class="fragment"><div class="line">                      forward             <a class="code" href="group__MatrixAlgebra.html#ga898e3fc2bdea632e7307604325b88016">inverse</a></div>
<div class="line">------------------------------------------------------------</div>
<div class="line">X <a class="code" href="group__MathFunctions.html#ga3cf86b8d2300cd08b69024eb89f90115">even</a>, Y even           1.0         4.0 * (w-1) * (h-1)</div>
<div class="line">X <a class="code" href="group__MathFunctions.html#ga3cf86b8d2300cd08b69024eb89f90115">even</a>, Y <a class="code" href="group__MathFunctions.html#ga48f661149941ebaa90ddd99ee5eee145">odd</a>           -1.0        -4.0 * (w-1) * (h+1)</div>
<div class="line">X <a class="code" href="group__MathFunctions.html#ga48f661149941ebaa90ddd99ee5eee145">odd</a>,  Y even          -1.0        -4.0 * (w+1) * (h-1)</div>
<div class="line">X <a class="code" href="group__MathFunctions.html#ga48f661149941ebaa90ddd99ee5eee145">odd</a>,  Y odd            1.0         4.0 * (w+1) * (h+1)</div>
</div><!-- fragment --><p>where <code>w</code> and <code>h</code> denote the image width and height.</p>
<p><b> Declarations:</b></p>
<p>pass 2D array views: </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcTraverser, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestTraverser, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    fourierTransformRealEE(SrcTraverser sul, SrcTraverser slr, SrcAccessor src,</div>
<div class="line">                           DestTraverser dul, DestAccessor dest, fftw_real <a class="code" href="group__FFTWComplexOperators.html#ga396baa79e8bd78a178597d32d5152041">norm</a>);</div>
<div class="line"></div>
<div class="line">    fourierTransformRealEO, fourierTransformRealOE, fourierTransformRealOO likewise</div>
<div class="line">}</div>
</div><!-- fragment --><p>pass <a class="el" href="group__ImageIterators.html">Image Iterators</a> and <a class="el" href="group__DataAccessors.html">Data Accessors</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcTraverser, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestTraverser, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    fourierTransformRealEE(SrcTraverser sul, SrcTraverser slr, SrcAccessor src,</div>
<div class="line">                           DestTraverser dul, DestAccessor dest, fftw_real <a class="code" href="group__FFTWComplexOperators.html#ga396baa79e8bd78a178597d32d5152041">norm</a>);</div>
<div class="line"></div>
<div class="line">    fourierTransformRealEO, fourierTransformRealOE, fourierTransformRealOO likewise</div>
<div class="line">}</div>
</div><!-- fragment --><p>use argument objects in conjunction with <a class="el" href="ArgumentObjectFactories.html">Argument Object Factories</a> : </p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>vigra {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class </span>SrcTraverser, <span class="keyword">class </span>SrcAccessor,</div>
<div class="line">              <span class="keyword">class </span>DestTraverser, <span class="keyword">class </span>DestAccessor&gt;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    fourierTransformRealEE(triple&lt;SrcTraverser, SrcTraverser, SrcAccessor&gt; src,</div>
<div class="line">                           pair&lt;DestTraverser, DestAccessor&gt; dest, fftw_real <a class="code" href="group__FFTWComplexOperators.html#ga396baa79e8bd78a178597d32d5152041">norm</a>);</div>
<div class="line"></div>
<div class="line">    fourierTransformRealEO, fourierTransformRealOE, fourierTransformRealOO likewise</div>
<div class="line">}</div>
</div><!-- fragment --><p><b> Usage:</b></p>
<p><b>#include</b> &lt;<a class="el" href="fftw3_8hxx_source.html">vigra/fftw3.hxx</a>&gt;<br/>
 Namespace: vigra</p>
<div class="fragment"><div class="line"><a class="code" href="classvigra_1_1BasicImage.html">vigra::FImage</a> spatial(width,height), fourier(width,height);</div>
<div class="line">... <span class="comment">// fill image with data</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// forward cosine transform == reflective boundary conditions</span></div>
<div class="line">fourierTransformRealEE(srcImageRange(spatial), destImage(fourier), (fftw_real)1.0);</div>
<div class="line"></div>
<div class="line"><span class="comment">// multiply with a first derivative of Gaussian in x-direction</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = 0; y &lt; height; ++y)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = 1; x &lt; width; ++x)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">double</span> dx = x * M_PI / (width - 1);</div>
<div class="line">        <span class="keywordtype">double</span> dy = y * M_PI / (height - 1);</div>
<div class="line">        fourier(x-1, y) = fourier(x, y) * dx * <a class="code" href="group__LinearAlgebraFunctions.html#ga2a9e01ae7ae7b39a618e9f4a6afaee5b">std::exp</a>(-(dx*dx + dy*dy) * scale*scale / 2.0);</div>
<div class="line">    }</div>
<div class="line">    fourier(width-1, y) = 0.0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// inverse transform -- odd symmetry in x-direction, even in y,</span></div>
<div class="line"><span class="comment">//                      due to symmetry of the filter</span></div>
<div class="line">fourierTransformRealOE(srcImageRange(fourier), destImage(spatial),</div>
<div class="line">                       (fftw_real)-4.0 * (width+1) * (height-1));</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gafbea828444f49163293b1d81fcd05da8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TinyVector&lt;T, N&gt; vigra::fftwCorrespondingShapeR2C </td>
          <td>(</td>
          <td class="paramtype">TinyVector&lt; T, N &gt;&#160;</td>
          <td class="paramname"><em>shape</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find frequency domain shape for a R2C Fourier transform. </p>
<p>When a real valued array is transformed to the frequency domain, about half of the Fourier coefficients are redundant. The transform can be optimized as a <a href="http://www.fftw.org/doc/Multi_002dDimensional-DFTs-of-Real-Data.html">R2C transform</a> that doesn't compute and store the redundant coefficients. This function computes the appropriate frequency domain shape for a given shape in the spatial domain. It simply replaces <code>shape[0]</code> with <code>shape[0] / 2 + 1</code>.</p>
<p><b>#include</b> &lt;<a class="el" href="multi__fft_8hxx_source.html">vigra/multi_fft.hxx</a>&gt;<br/>
 Namespace: vigra </p>

</div>
</div>
</div><!-- contents -->
<!-- footer.html -->
<p>
<table border=0 cellspacing=0 width="100%"  bgcolor="#e0d0a0" cellpadding=5>
<tr>
<td>
<p>
<i>&copy; <A HREF="http://hci.iwr.uni-heidelberg.de/people/ukoethe/">Ullrich K&ouml;the</A>     (<A
HREF="mailto:ullrich.koethe@iwr.uni-heidelberg.de">ullrich.koethe@iwr.uni-heidelberg.de</A>)</i> <br>
<i><A HREF="http://hci.iwr.uni-heidelberg.de/">
Heidelberg Collaboratory for Image Processing</a>,
University of Heidelberg, Germany</i>
<td>
<p align=right>
<I>html generated using <A HREF="http://www.doxygen.org">doxygen</A> and <A HREF="http://www.python.org">Python</A></I>
<br>
<i>
vigra 1.11.0 (Thu Mar 17 2016)
</i>
</tr>
</table>
</BODY>
</HTML>
